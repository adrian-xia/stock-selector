# Stock Selector — 项目总体计划

> 最后更新: 2026-02-27

## 版本概览

| 版本 | 定位 | 状态 |
|------|------|------|
| V1 | 基础框架 + 数据采集 + 策略引擎 | ✅ 已完成 |
| V2 | 策略扩充 + 财务数据 + 性能优化 | ✅ 已完成 |
| V3 | 量价策略 + 命中率追踪 + 权重调整 + 交易计划 + UI 重构 | 🔄 进行中 |

---

## V3 任务清单

### ✅ 已完成

| 编号 | 任务 | 完成日期 | 说明 |
|------|------|----------|------|
| V3-1 | Snapshot SQL 扩展 | 2026-02-27 | +5 字段 (obv, donchian_upper/lower, open_prev, pct_chg_prev) |
| V3-2 | 6 个量价策略实现 | 2026-02-27 | 策略总数 28→34 |
| V3-3 | 量价策略文档更新 | 2026-02-27 | PROJECT_TASKS.md 同步 |
| V3-4 | 盘后链路策略注册制 | 2026-02-27 | 已完成 |
| V3-5 | 策略命中率追踪 | 2026-02-27 | strategy_picks + strategy_hit_stats 表，盘后自动回填 |
| V3-6 | 60 天历史回填 | 2026-02-27 | 22297 条选股记录，21 个策略命中率数据 |

### 🔄 进行中

| 编号 | 任务 | 优先级 | 预估工时 | 说明 |
|------|------|--------|----------|------|
| V3-7 | 策略权重动态调整 | P1 | 2-3h | 基于命中率自动调整排序权重，替代简单 match_count |

### 📋 待开发

| 编号 | 任务 | 优先级 | 预估工时 | 说明 |
|------|------|--------|----------|------|
| V3-8 | 交易计划引擎 | P2 | 3-5d | 基于 T 日数据生成 T+1 触发条件/止损位 |
| V3-9 | 数据库分区 | P3 | 2-3d | stock_daily 1300 万行，按年/月分区提升查询性能 |
| V3-10 | 板块/行业筛选 | P2 | 2-3d | 申万行业分类，支持按板块过滤选股 |
| V3-11 | 前端 Ant Design 重构 | P3 | 5-7d | React + Ant Design 专业 Dashboard |
| V3-12 | AI 协作接口 (Headless) | P3 | 2-3d | OpenClaw Skill，Webhook 回调 |

---

## 交易计划引擎设计 (V3-8)

来源: `00-V3概要设计.md`

**核心思路:** 每日收盘后扫描全市场，生成"明日关注清单"

**数据模型 (Prediction):**
- target_code: 标的代码
- trigger_condition: 触发条件 (Price > X, MA5 > MA10)
- trigger_price: 触发价格
- stop_loss: 建议止损位
- valid_until: 有效期 (T+1)

**API:**
- `POST /api/plan/generate` — 生成计划
- `GET /api/plan/latest` — 获取最新计划 (供 AI 读取)

**实施步骤:**
1. 改造 BaseStrategy，增加 `predict()` 方法
2. 升级现有策略实现 predict 逻辑
3. 开发 TradePlanManager 服务
4. 开发 API 端点

---

## 前端重构设计 (V3-11)

来源: `00-V3概要设计.md`

**风格:** 极简 Dashboard，行情查看交给同花顺

**核心页面:**
1. 看板 (Dashboard) — 明日关注清单 + 系统状态 + 命中率概览
2. 选股中心 (Screener) — 板块/行业筛选 + 市场复选 + 表格展示
3. 回测实验室 (Backtest) — 批量回测 + 收益率/胜率/盈亏比
4. 策略分析 (Strategy) — 命中率趋势 + 权重分布 + 历史选股记录

---

## 建议实施顺序

```
V3-7 策略权重动态调整 (P1, 2-3h)
  ↓
V3-10 板块/行业筛选 (P2, 2-3d)
  ↓
V3-8 交易计划引擎 (P2, 3-5d)
  ↓
V3-9 数据库分区 (P3, 2-3d)
  ↓
V3-11 前端重构 (P3, 5-7d)
  ↓
V3-12 AI 协作接口 (P3, 2-3d)
```

总预估: 15-23 个工作日
